Feature: Test Encryption module

  # Encryption tests

  Scenario: Test decrypting a known value
    Given bytes:
    """
    -85,103,72,61,5,-17,8,-54,35,48,52,-8,65,8,61,-24,-100,0,-33,-77,-2,33,106,22,88,9,-73,-56,-64,39,68,-23,50,-71,34,76,-106,14,31,74,-79,-27,9,99,-35,33,105,59,16,87,-106,-115,-80,109,15,-54,24,-122,82,70,34,-100,93,10,7,41,26,43,40,71,-121,-123,-46,-45,120,27,74,87,63,-108,95,-63,-125,86,-8,64,-92,-96,-18,98,59,-118,-116,-45,-49,72,-83,88,-46,71,-21,127,-40,-53,-85,42,69,-127,13,56,22,-93,58,-2,-26,-38,28,-53,-42,46,-18,-87,-73,-18,78,-121,90,-49,-94,112,4,-11,-73,-15,75,15,-14,23,-45,-51,62,30,89,-1,114,-55,-123,-49,-20,71,-33,73,24,50,38,-64,26,47,24,-66,40,10,38,86,82,-60,33,18,1,21,99,59,-49,83,113,-79,-122,-122,-11,25,-58,-16,71,-46,-97,12,79,-16,59,43,83,113,39,-84,-63,-128,-78,-103,-112,34,-32,125,-3,-82,-118,-20,88,-120,-55,28,127,104,-35,-93,-104,111,100,-28,-75,71,114,9,30,72,-114,-106,57,-122,4,-96,9,-57,-69,-49,70,125,-97,-115,66,-99,-74,-5,-99,42,2,43,-13,7,127,64,-78,64,-63,42,-90,80,10,-110,116,58,-63,74,29,-128,112,86,-49,104,-122,-18,101,-116,83,-99,125,83,-62,27,-50,60,-109,104,-102,-85,-57,-81,10,-106,-86,-107,105,60,125,118,59,83,-83,-35,3,-11,-17,64,40,-113
    """
    When bytes are decrypted with key -326913117
    Then result bytes should be:
    """
    32,0,0,0,-92,60,0,0,84,-57,1,0,0,2,0,-128,-60,60,0,0,-26,0,0,0,-75,2,0,0,0,2,0,-128,-86,61,0,0,-46,1,0,0,-72,4,0,0,0,2,0,-128,124,63,0,0,86,35,0,0,-52,117,0,0,0,2,0,-128,-46,98,0,0,107,1,0,0,47,5,0,0,0,2,0,-128,61,100,0,0,25,47,0,0,99,-32,0,0,0,2,0,-128,86,-109,0,0,-60,7,0,0,0,0,4,0,0,2,0,-128,26,-101,0,0,42,10,0,0,-31,16,0,0,0,2,0,-128,68,-91,0,0,91,0,0,0,-56,0,0,0,0,2,0,-128,-97,-91,0,0,70,14,0,0,16,0,4,0,0,2,0,-128,-27,-77,0,0,28,0,0,0,24,0,0,0,0,2,0,-128,1,-76,0,0,-84,1,0,0,86,11,0,0,0,2,0,-128,-83,-75,0,0,71,0,0,0,84,0,0,0,0,2,0,-128,-12,-75,0,0,16,0,0,0,8,0,0,0,0,2,0,-128,4,-74,0,0,-44,1,0,0,-84,10,0,0,0,2,0,-128,-40,-73,0,0,-122,0,0,0,29,1,0,0,0,2,0,-128,94,-72,0,0,-17,0,0,0,-68,1,0,0,0,2,0,-128,77,-71,0,0,-17,0,0,0,-68,1,0,0,0,2,0,-128,60,-70,0,0,109,0,0,0,-8,0,0,0,0,2,3,-128
    """

  Scenario: Test encrypting a known value
    Given bytes:
    """
    32,0,0,0,-92,60,0,0,84,-57,1,0,0,2,0,-128,-60,60,0,0,-26,0,0,0,-75,2,0,0,0,2,0,-128,-86,61,0,0,-46,1,0,0,-72,4,0,0,0,2,0,-128,124,63,0,0,86,35,0,0,-52,117,0,0,0,2,0,-128,-46,98,0,0,107,1,0,0,47,5,0,0,0,2,0,-128,61,100,0,0,25,47,0,0,99,-32,0,0,0,2,0,-128,86,-109,0,0,-60,7,0,0,0,0,4,0,0,2,0,-128,26,-101,0,0,42,10,0,0,-31,16,0,0,0,2,0,-128,68,-91,0,0,91,0,0,0,-56,0,0,0,0,2,0,-128,-97,-91,0,0,70,14,0,0,16,0,4,0,0,2,0,-128,-27,-77,0,0,28,0,0,0,24,0,0,0,0,2,0,-128,1,-76,0,0,-84,1,0,0,86,11,0,0,0,2,0,-128,-83,-75,0,0,71,0,0,0,84,0,0,0,0,2,0,-128,-12,-75,0,0,16,0,0,0,8,0,0,0,0,2,0,-128,4,-74,0,0,-44,1,0,0,-84,10,0,0,0,2,0,-128,-40,-73,0,0,-122,0,0,0,29,1,0,0,0,2,0,-128,94,-72,0,0,-17,0,0,0,-68,1,0,0,0,2,0,-128,77,-71,0,0,-17,0,0,0,-68,1,0,0,0,2,0,-128,60,-70,0,0,109,0,0,0,-8,0,0,0,0,2,3,-128
    """
    When bytes are encrypted with key -326913117
    Then result bytes should be:
    """
    -85,103,72,61,5,-17,8,-54,35,48,52,-8,65,8,61,-24,-100,0,-33,-77,-2,33,106,22,88,9,-73,-56,-64,39,68,-23,50,-71,34,76,-106,14,31,74,-79,-27,9,99,-35,33,105,59,16,87,-106,-115,-80,109,15,-54,24,-122,82,70,34,-100,93,10,7,41,26,43,40,71,-121,-123,-46,-45,120,27,74,87,63,-108,95,-63,-125,86,-8,64,-92,-96,-18,98,59,-118,-116,-45,-49,72,-83,88,-46,71,-21,127,-40,-53,-85,42,69,-127,13,56,22,-93,58,-2,-26,-38,28,-53,-42,46,-18,-87,-73,-18,78,-121,90,-49,-94,112,4,-11,-73,-15,75,15,-14,23,-45,-51,62,30,89,-1,114,-55,-123,-49,-20,71,-33,73,24,50,38,-64,26,47,24,-66,40,10,38,86,82,-60,33,18,1,21,99,59,-49,83,113,-79,-122,-122,-11,25,-58,-16,71,-46,-97,12,79,-16,59,43,83,113,39,-84,-63,-128,-78,-103,-112,34,-32,125,-3,-82,-118,-20,88,-120,-55,28,127,104,-35,-93,-104,111,100,-28,-75,71,114,9,30,72,-114,-106,57,-122,4,-96,9,-57,-69,-49,70,125,-97,-115,66,-99,-74,-5,-99,42,2,43,-13,7,127,64,-78,64,-63,42,-90,80,10,-110,116,58,-63,74,29,-128,112,86,-49,104,-122,-18,101,-116,83,-99,125,83,-62,27,-50,60,-109,104,-102,-85,-57,-81,10,-106,-86,-107,105,60,125,118,59,83,-83,-35,3,-11,-17,64,40,-113
    """

  # Hashing tests

  Scenario: Test hashing a known value
    Given string value "(hash table)"
    When integer hash is computed with type 3
    Then hash should be -1011927184

  Scenario: Test hashing a known value
    Given string value "(block table)"
    When integer hash is computed with type 3
    Then hash should be -326913117

  Scenario: Test hashing a known value
    Given string value "war3map.j"
    When integer hash is computed with type 1
    Then hash should be -912848921

  Scenario: Test hashing a known value
    Given string value "war3map.j"
    When integer hash is computed with type 2
    Then hash should be -1783098290

